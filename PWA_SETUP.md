# PWA Setup Instructions for Penny

## Current Status

‚úÖ PWA configuration complete  
‚úÖ manifest.json created  
‚úÖ Service worker enabled  
‚úÖ Offline caching configured  
‚ö†Ô∏è App icons need to be generated

## Generating App Icons

The project includes an SVG icon template at `public/icon.svg`. You need to convert this to PNG format in two sizes:

### Required Icon Sizes:
- `public/icon-192.png` (192x192 pixels)
- `public/icon-512.png` (512x512 pixels)

### Options for Generation:

#### Option 1: Online Tools
1. Go to [RealFaviconGenerator](https://realfavicongenerator.net/) or similar
2. Upload `public/icon.svg`
3. Download the generated icons
4. Rename to `icon-192.png` and `icon-512.png`
5. Place in `public/` folder

#### Option 2: Command Line (ImageMagick)
```bash
# Install ImageMagick if not already installed
# macOS: brew install imagemagick
# Ubuntu: sudo apt-get install imagemagick

# Generate icons
convert public/icon.svg -resize 192x192 public/icon-192.png
convert public/icon.svg -resize 512x512 public/icon-512.png
```

#### Option 3: Use Design Tools
- Open `public/icon.svg` in Figma, Sketch, or Adobe Illustrator
- Export as PNG at 192x192 and 512x512

## Testing PWA Features

### 1. Install PWA Locally

**On Desktop (Chrome):**
1. Run `npm run dev` or `npm start`
2. Open Chrome
3. Navigate to `http://localhost:3000`
4. Look for install icon in address bar
5. Click to install Penny as an app

**On Mobile:**
1. Deploy to a testing server with HTTPS
2. Open in mobile browser
3. Look for "Add to Home Screen" prompt
4. Install and open as standalone app

### 2. Test Offline Functionality

1. Open Penny in browser
2. Open DevTools ‚Üí Network tab
3. Check "Offline" mode
4. Navigate between pages
5. Try adding an expense (should queue to IndexedDB)
6. Re-enable network
7. Watch expense sync automatically

### 3. Verify Service Worker

1. Open DevTools ‚Üí Application tab
2. Click "Service Workers" in sidebar
3. Verify service worker is registered and activated
4. Check "Update on reload" for development

## PWA Features Enabled

### Offline Support
- ‚úÖ Static assets cached
- ‚úÖ API responses cached with NetworkFirst strategy
- ‚úÖ Images cached with StaleWhileRevalidate
- ‚úÖ Fonts cached for 1 year
- ‚úÖ Automatic background sync via IndexedDB

### App Features
- ‚úÖ Standalone mode (no browser UI)
- ‚úÖ Splash screen on launch
- ‚úÖ App shortcuts (Add Expense, Dashboard)
- ‚úÖ Theme color for status bar
- ‚úÖ Proper viewport settings

### Caching Strategy

**NetworkFirst (Default):**
- HTML pages
- API routes
- Falls back to cache if network fails

**StaleWhileRevalidate:**
- Images
- Fonts
- CSS/JS files
- Shows cached version immediately, updates in background

**CacheFirst:**
- Google Fonts
- Long-term cached assets

## Deployment Requirements

### For Full PWA Support:
1. **HTTPS Required**: PWAs only work over HTTPS (except localhost)
2. **Valid SSL Certificate**: Use Let's Encrypt or hosting provider's SSL
3. **Service Worker Registration**: Automatically handled by next-pwa
4. **App Icons**: Must be present for install prompt

### Recommended Hosting:
- **Vercel** (easiest for Next.js)
- **Netlify**
- **Firebase Hosting**
- **AWS Amplify**
- **Cloudflare Pages**

## Service Worker Configuration

The service worker is automatically generated by next-pwa and includes:

- **Runtime Caching**: 10 different caching strategies
- **Offline Fallback**: Shows cached content when offline
- **Auto Updates**: Service worker updates on page refresh
- **Background Sync**: Queues failed requests for retry

### Cache Expiration:
- **Fonts**: 365 days
- **Images**: 24 hours
- **Static Assets**: 24 hours
- **API Responses**: 24 hours

## Troubleshooting

### Service Worker Not Registering
- Check browser console for errors
- Verify HTTPS is enabled (or using localhost)
- Clear browser cache and service workers
- Reload page with DevTools open

### Icons Not Showing
- Ensure PNG files are in `public/` folder
- Verify manifest.json paths are correct
- Clear browser cache
- Check file sizes (should be 192x192 and 512x512)

### Offline Mode Not Working
- Verify service worker is active in DevTools
- Check Network tab for cache hits
- Review IndexedDB for queued requests
- Ensure next-pwa is properly configured

### Install Prompt Not Appearing
- Verify all PWA criteria met (HTTPS, valid manifest, service worker)
- Ensure icons are present and correct sizes
- Check browser console for PWA errors
- Some browsers have install criteria beyond basic PWA requirements

## Next Steps

1. **Generate app icons** (see above)
2. **Test locally** with generated icons
3. **Deploy to production** with HTTPS
4. **Test installation** on mobile and desktop
5. **Test offline functionality** thoroughly
6. **Monitor service worker** for errors

## Resources

- [next-pwa Documentation](https://github.com/shadowwalker/next-pwa)
- [PWA Checklist](https://web.dev/pwa-checklist/)
- [Service Worker API](https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API)
- [Web App Manifest](https://developer.mozilla.org/en-US/docs/Web/Manifest)

---

**üéâ Once icons are generated, Penny will be a fully functional Progressive Web App!**
